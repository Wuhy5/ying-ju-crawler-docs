# 核心概念

## 什么是媒体爬虫规范

媒体爬虫规范是一个统一的规则格式，专门用于从各种网站上获取影视、音频、图书和漫画等媒体内容信息。它就像是一套标准化的"配方"，告诉爬虫程序如何从不同的网站上提取数据。

想象一下，你想从一个视频网站上获取电影信息。按照传统方式，你需要编写复杂的代码来处理网页结构、数据提取等各种细节。而使用这个规范，你只需要用简单的 TOML 格式写一个配置文件，程序就能自动理解如何获取数据。

这个规范的设计目标是让规则编写变得简单直观，即使是普通用户也能通过配置来定制自己的数据采集需求。

## 规则文件的基本结构

每个数据源都对应一个 TOML 格式的规则文件。这个文件包含了从网站获取数据的完整指令。

### 元数据部分
规则文件首先定义基本信息，比如：
- 规则名称和版本
- 目标网站的域名
- 适用的媒体类型（视频、音频、图书或漫画）
- 作者信息

这些信息帮助程序识别和管理不同的规则。

### 配置部分
接下来是各种配置项：
- **网络配置**：设置请求头、超时时间、代理等
- **缓存配置**：决定如何存储临时数据以提高效率
- **脚本配置**：如果需要复杂的数据处理逻辑

### 组件和流程
规则的核心是组件和流程的定义：
- **组件**：可重用的数据处理模块
- **流程**：具体的执行步骤，定义如何触发数据采集

## 处理管道的概念

处理管道是规范的核心机制，它将复杂的数据提取过程分解为一系列简单的步骤。

### 管道的工作原理

想象你在厨房做饭，制作一道复杂的菜品。按照传统方式，你需要同时处理很多事情。而使用管道，就像生产线一样：

1. **原材料准备**（发送网络请求获取网页）
2. **初步加工**（从 HTML 中提取基本信息）
3. **精细加工**（转换数据格式，提取具体字段）
4. **质量检查**（验证数据完整性）
5. **成品包装**（输出标准格式的数据）

每个步骤只负责一件事情，步骤之间通过数据传递连接起来。

### 管道的优势

这种设计带来了几个重要好处：

**简单性**：每个步骤都很简单，容易理解和修改
**灵活性**：可以根据需要调整或替换步骤
**可重用性**：相同的步骤可以在不同场景下重复使用
**可维护性**：当网站结构变化时，只需要修改相关步骤

### 实际应用

例如，从一个视频网站获取电影列表：

1. 发送请求获取列表页面
2. 从 HTML 中提取所有电影链接
3. 对每个链接分别获取详情页面
4. 从详情页面提取标题、导演、演员等信息
5. 将所有信息整理成标准格式输出

## 媒体类型系统

规范支持多种媒体类型，每种类型都有对应的数据模型。

### 支持的媒体类型

- **视频**：电影、电视剧、动漫等
- **音频**：音乐、播客、有声书等
- **图书**：电子书、漫画等
- **漫画**：在线漫画、图画小说等

### 类型特定的配置

不同媒体类型可能需要不同的字段和处理方式。例如：

- 视频类型需要时长、分辨率等技术信息
- 图书类型需要页数、ISBN 等出版信息
- 音频类型需要比特率、时长等音频特性

### 统一的数据输出

虽然不同媒体类型的数据结构不同，但规范定义了统一的输出格式：

- **列表数据**：用于展示搜索结果或分类列表
- **详情数据**：用于展示完整的内容信息

这种设计让上层应用能够统一处理来自不同数据源的各种媒体内容。

## 设计理念

### 用户友好的配置

规范的核心理念是让配置变得简单直观。使用 TOML 格式而不是复杂的编程语言，让普通用户也能编写规则。

### 声明式配置

采用声明式配置方式，告诉程序"做什么"而不是"怎么做"。例如，不需要编写循环代码，只需要描述数据转换的规则。

### 渐进式复杂度

从简单配置开始，根据需要逐步增加复杂度。新手可以从基础配置开始，熟练后可以使用高级功能。

### 标准化与扩展

通过标准化的数据模型和处理流程，确保不同规则之间的一致性。同时保留扩展性，支持自定义处理逻辑。

这种设计让用户能够专注于数据采集的目标，而不是技术实现的细节。
